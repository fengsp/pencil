<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <meta name="description" content="API documentation for the Rust `Pencil` struct in crate `pencil`.">
    <meta name="keywords" content="rust, rustlang, rust-lang, Pencil">

    <title>pencil::Pencil - Rust</title>

    <link rel="stylesheet" type="text/css" href="../rustdoc.css">
    <link rel="stylesheet" type="text/css" href="../main.css">
    

    <link rel="shortcut icon" href="https://raw.githubusercontent.com/fengsp/pencil/master/logo/favicon.ico">
    
</head>
<body class="rustdoc">
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->

    

    <nav class="sidebar">
        <a href='../pencil/index.html'><img src='https://raw.githubusercontent.com/fengsp/pencil/master/logo/pencil.png' alt='logo' width='100'></a>
        <p class='location'><a href='index.html'>pencil</a></p><script>window.sidebarCurrent = {name: 'Pencil', ty: 'struct', relpath: ''};</script><script defer src="sidebar-items.js"></script>
    </nav>

    <nav class="sub">
        <form class="search-form js-only">
            <div class="search-container">
                <input class="search-input" name="search"
                       autocomplete="off"
                       placeholder="Click or press ‘S’ to search, ‘?’ for more options…"
                       type="search">
            </div>
        </form>
    </nav>

    <section id='main' class="content struct">
<h1 class='fqn'><span class='in-band'>Struct <a href='index.html'>pencil</a>::<wbr><a class='struct' href=''>Pencil</a></span><span class='out-of-band'><span id='render-detail'>
                   <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">
                       [<span class='inner'>&#x2212;</span>]
                   </a>
               </span><a id='src-947' class='srclink' href='../src/pencil/src/app.rs.html#52-80' title='goto source code'>[src]</a></span></h1>
<pre class='rust struct'>pub struct Pencil {
    pub root_path: <a class='struct' href='https://doc.rust-lang.org/nightly/collections/string/struct.String.html' title='collections::string::String'>String</a>,
    pub name: <a class='struct' href='https://doc.rust-lang.org/nightly/collections/string/struct.String.html' title='collections::string::String'>String</a>,
    pub static_folder: <a class='struct' href='https://doc.rust-lang.org/nightly/collections/string/struct.String.html' title='collections::string::String'>String</a>,
    pub static_url_path: <a class='struct' href='https://doc.rust-lang.org/nightly/collections/string/struct.String.html' title='collections::string::String'>String</a>,
    pub template_folder: <a class='struct' href='https://doc.rust-lang.org/nightly/collections/string/struct.String.html' title='collections::string::String'>String</a>,
    pub config: <a class='struct' href='../pencil/config/struct.Config.html' title='pencil::config::Config'>Config</a>,
    pub handlebars_registry: <a class='struct' href='https://doc.rust-lang.org/nightly/std/sync/rwlock/struct.RwLock.html' title='std::sync::rwlock::RwLock'>RwLock</a>&lt;<a class='struct' href='https://doc.rust-lang.org/nightly/alloc/boxed/struct.Box.html' title='alloc::boxed::Box'>Box</a>&lt;<a class='struct' href='../handlebars/registry/struct.Registry.html' title='handlebars::registry::Registry'>Handlebars</a>&gt;&gt;,
    pub url_map: <a class='struct' href='../pencil/routing/struct.Map.html' title='pencil::routing::Map'>Map</a>,
    pub modules: <a class='struct' href='https://doc.rust-lang.org/nightly/std/collections/hash/map/struct.HashMap.html' title='std::collections::hash::map::HashMap'>HashMap</a>&lt;<a class='struct' href='https://doc.rust-lang.org/nightly/collections/string/struct.String.html' title='collections::string::String'>String</a>,&nbsp;<a class='struct' href='../pencil/struct.Module.html' title='pencil::Module'>Module</a>&gt;,
    // some fields omitted
}</pre><div class='docblock'><p>The pencil type.  It acts as the central application object.  Once it is created it
will act as a central registry for the view functions, the URL rules and much more.</p>
</div><h2 class='fields'>Fields</h2><span id='structfield.root_path' class='structfield'><code>root_path: <a class='struct' href='https://doc.rust-lang.org/nightly/collections/string/struct.String.html' title='collections::string::String'>String</a></code>
                           </span><span class='stab '></span><div class='docblock'><p>The path where your application locates.</p>
</div><span id='structfield.name' class='structfield'><code>name: <a class='struct' href='https://doc.rust-lang.org/nightly/collections/string/struct.String.html' title='collections::string::String'>String</a></code>
                           </span><span class='stab '></span><div class='docblock'><p>The name of the application.  By default it&#39;s guessed from the root path.</p>
</div><span id='structfield.static_folder' class='structfield'><code>static_folder: <a class='struct' href='https://doc.rust-lang.org/nightly/collections/string/struct.String.html' title='collections::string::String'>String</a></code>
                           </span><span class='stab '></span><div class='docblock'><p>The folder with static files that should be served at <code>static_url_path</code>.
Defaults to the <code>&quot;static&quot;</code> folder in the root path of the application.</p>
</div><span id='structfield.static_url_path' class='structfield'><code>static_url_path: <a class='struct' href='https://doc.rust-lang.org/nightly/collections/string/struct.String.html' title='collections::string::String'>String</a></code>
                           </span><span class='stab '></span><div class='docblock'><p>The url path for the static files on the web, defaults to be <code>&quot;/static&quot;</code>.</p>
</div><span id='structfield.template_folder' class='structfield'><code>template_folder: <a class='struct' href='https://doc.rust-lang.org/nightly/collections/string/struct.String.html' title='collections::string::String'>String</a></code>
                           </span><span class='stab '></span><div class='docblock'><p>The folder that contains the templates that should be used for the application.
Defaults to <code>&#39;&#39;templates&#39;&#39;</code> folder in the root path of the application.</p>
</div><span id='structfield.config' class='structfield'><code>config: <a class='struct' href='../pencil/config/struct.Config.html' title='pencil::config::Config'>Config</a></code>
                           </span><span class='stab '></span><div class='docblock'><p>The configuration for this application.</p>
</div><span id='structfield.handlebars_registry' class='structfield'><code>handlebars_registry: <a class='struct' href='https://doc.rust-lang.org/nightly/std/sync/rwlock/struct.RwLock.html' title='std::sync::rwlock::RwLock'>RwLock</a>&lt;<a class='struct' href='https://doc.rust-lang.org/nightly/alloc/boxed/struct.Box.html' title='alloc::boxed::Box'>Box</a>&lt;<a class='struct' href='../handlebars/registry/struct.Registry.html' title='handlebars::registry::Registry'>Handlebars</a>&gt;&gt;</code>
                           </span><span class='stab '></span><div class='docblock'><p>The Handlebars registry used to load templates and register helpers.</p>
</div><span id='structfield.url_map' class='structfield'><code>url_map: <a class='struct' href='../pencil/routing/struct.Map.html' title='pencil::routing::Map'>Map</a></code>
                           </span><span class='stab '></span><div class='docblock'><p>The url map for this pencil application.</p>
</div><span id='structfield.modules' class='structfield'><code>modules: <a class='struct' href='https://doc.rust-lang.org/nightly/std/collections/hash/map/struct.HashMap.html' title='std::collections::hash::map::HashMap'>HashMap</a>&lt;<a class='struct' href='https://doc.rust-lang.org/nightly/collections/string/struct.String.html' title='collections::string::String'>String</a>,&nbsp;<a class='struct' href='../pencil/struct.Module.html' title='pencil::Module'>Module</a>&gt;</code>
                           </span><span class='stab '></span><div class='docblock'><p>All the attached modules in a hashmap by name.</p>
</div><h2 id='methods'>Methods</h2><h3 class='impl'><span class='in-band'><code>impl <a class='struct' href='../pencil/struct.Pencil.html' title='pencil::Pencil'>Pencil</a></code></span><span class='out-of-band'><div class='ghost'></div><a id='src-965' class='srclink' href='../src/pencil/src/app.rs.html#89-589' title='goto source code'>[src]</a></span></h3>
<div class='impl-items'><h4 id='method.new' class='method'><code>fn <a href='#method.new' class='fnname'>new</a>(root_path: &amp;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.str.html'>str</a>) -&gt; <a class='struct' href='../pencil/struct.Pencil.html' title='pencil::Pencil'>Pencil</a></code></h4>
<div class='docblock'><p>Create a new pencil object.  It is passed the root path of your application.
The root path is used to resolve resources from inside it, for more information
about resource loading, see method <code>open_resource</code>.</p>

<p>Usually you create a pencil object in your main function like this:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>use</span> <span class='ident'>pencil</span>::<span class='ident'>Pencil</span>;

<span class='kw'>fn</span> <span class='ident'>main</span>() {
    <span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>app</span> <span class='op'>=</span> <span class='ident'>Pencil</span>::<span class='ident'>new</span>(<span class='string'>&quot;/web/myapp&quot;</span>);
}</pre>
</div><h4 id='method.is_debug' class='method'><code>fn <a href='#method.is_debug' class='fnname'>is_debug</a>(&amp;self) -&gt; <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.bool.html'>bool</a></code></h4>
<div class='docblock'><p>The debug flag.  This field is configured from the config
with the <code>DEBUG</code> configuration key.  Defaults to <code>False</code>.</p>
</div><h4 id='method.is_testing' class='method'><code>fn <a href='#method.is_testing' class='fnname'>is_testing</a>(&amp;self) -&gt; <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.bool.html'>bool</a></code></h4>
<div class='docblock'><p>The testing flag.  This field is configured from the config
with the <code>TESTING</code> configuration key.  Defaults to <code>False</code>.</p>
</div><h4 id='method.set_debug' class='method'><code>fn <a href='#method.set_debug' class='fnname'>set_debug</a>(&amp;mut self, flag: <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.bool.html'>bool</a>)</code></h4>
<div class='docblock'><p>Set the debug flag.  This field is configured from the config
with the <code>DEBUG</code> configuration key.  Set this to <code>True</code> to
enable debugging of the application.</p>
</div><h4 id='method.set_testing' class='method'><code>fn <a href='#method.set_testing' class='fnname'>set_testing</a>(&amp;mut self, flag: <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.bool.html'>bool</a>)</code></h4>
<div class='docblock'><p>Set the testing flag.  This field is configured from the config
with the <code>TESTING</code> configuration key.  Set this to <code>True</code> to
enable the test mode of the application.</p>
</div><h4 id='method.set_log_level' class='method'><code>fn <a href='#method.set_log_level' class='fnname'>set_log_level</a>(&amp;self)</code></h4>
<div class='docblock'><p>Set global log level based on the application&#39;s debug flag.
This is only useful for <code>env_logger</code> crate users.
On debug mode, this turns on all debug logging.</p>
</div><h4 id='method.route' class='method'><code>fn <a href='#method.route' class='fnname'>route</a>&lt;M:&nbsp;<a class='trait' href='https://doc.rust-lang.org/nightly/core/convert/trait.Into.html' title='core::convert::Into'>Into</a>&lt;<a class='struct' href='../pencil/routing/struct.Matcher.html' title='pencil::routing::Matcher'>Matcher</a>&gt;,&nbsp;N:&nbsp;<a class='trait' href='https://doc.rust-lang.org/nightly/core/convert/trait.AsRef.html' title='core::convert::AsRef'>AsRef</a>&lt;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.slice.html'>[</a><a class='enum' href='../pencil/method/enum.Method.html' title='pencil::method::Method'>Method</a><a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.slice.html'>]</a>&gt;&gt;(&amp;mut self, rule: M, methods: N, endpoint: &amp;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.str.html'>str</a>, view_func: <a class='type' href='../pencil/type.ViewFunc.html' title='pencil::ViewFunc'>ViewFunc</a>)</code></h4>
<div class='docblock'><p>This is used to register a view function for a given URL rule.
Basically this example:</p>

<pre class='rust rust-example-rendered'>
<span class='ident'>app</span>.<span class='ident'>route</span>(<span class='string'>&quot;/home&quot;</span>, <span class='kw-2'>&amp;</span>[<span class='ident'>Get</span>], <span class='string'>&quot;home&quot;</span>, <span class='ident'>home</span>);
<span class='ident'>app</span>.<span class='ident'>route</span>(<span class='string'>&quot;/user/&lt;user_id:int&gt;&quot;</span>, <span class='kw-2'>&amp;</span>[<span class='ident'>Get</span>], <span class='string'>&quot;user&quot;</span>, <span class='ident'>user</span>);</pre>

<p>A rule that listens for <code>GET</code> will implicitly listen for <code>HEAD</code>.</p>
</div><h4 id='method.get' class='method'><code>fn <a href='#method.get' class='fnname'>get</a>&lt;M:&nbsp;<a class='trait' href='https://doc.rust-lang.org/nightly/core/convert/trait.Into.html' title='core::convert::Into'>Into</a>&lt;<a class='struct' href='../pencil/routing/struct.Matcher.html' title='pencil::routing::Matcher'>Matcher</a>&gt;&gt;(&amp;mut self, rule: M, endpoint: &amp;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.str.html'>str</a>, view_func: <a class='type' href='../pencil/type.ViewFunc.html' title='pencil::ViewFunc'>ViewFunc</a>)</code></h4>
<div class='docblock'><p>This is a shortcut for <code>route</code>, register a view function for
a given URL rule with just <code>GET</code> method (implicitly <code>HEAD</code>).</p>
</div><h4 id='method.post' class='method'><code>fn <a href='#method.post' class='fnname'>post</a>&lt;M:&nbsp;<a class='trait' href='https://doc.rust-lang.org/nightly/core/convert/trait.Into.html' title='core::convert::Into'>Into</a>&lt;<a class='struct' href='../pencil/routing/struct.Matcher.html' title='pencil::routing::Matcher'>Matcher</a>&gt;&gt;(&amp;mut self, rule: M, endpoint: &amp;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.str.html'>str</a>, view_func: <a class='type' href='../pencil/type.ViewFunc.html' title='pencil::ViewFunc'>ViewFunc</a>)</code></h4>
<div class='docblock'><p>This is a shortcut for <code>route</code>, register a view function for
a given URL rule with just <code>POST</code> method.</p>
</div><h4 id='method.delete' class='method'><code>fn <a href='#method.delete' class='fnname'>delete</a>&lt;M:&nbsp;<a class='trait' href='https://doc.rust-lang.org/nightly/core/convert/trait.Into.html' title='core::convert::Into'>Into</a>&lt;<a class='struct' href='../pencil/routing/struct.Matcher.html' title='pencil::routing::Matcher'>Matcher</a>&gt;&gt;(&amp;mut self, rule: M, endpoint: &amp;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.str.html'>str</a>, view_func: <a class='type' href='../pencil/type.ViewFunc.html' title='pencil::ViewFunc'>ViewFunc</a>)</code></h4>
<div class='docblock'><p>This is a shortcut for <code>route</code>, register a view function for
a given URL rule with just <code>DELETE</code> method.</p>
</div><h4 id='method.patch' class='method'><code>fn <a href='#method.patch' class='fnname'>patch</a>&lt;M:&nbsp;<a class='trait' href='https://doc.rust-lang.org/nightly/core/convert/trait.Into.html' title='core::convert::Into'>Into</a>&lt;<a class='struct' href='../pencil/routing/struct.Matcher.html' title='pencil::routing::Matcher'>Matcher</a>&gt;&gt;(&amp;mut self, rule: M, endpoint: &amp;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.str.html'>str</a>, view_func: <a class='type' href='../pencil/type.ViewFunc.html' title='pencil::ViewFunc'>ViewFunc</a>)</code></h4>
<div class='docblock'><p>This is a shortcut for <code>route</code>, register a view function for
a given URL rule with just <code>PATCH</code> method.</p>
</div><h4 id='method.put' class='method'><code>fn <a href='#method.put' class='fnname'>put</a>&lt;M:&nbsp;<a class='trait' href='https://doc.rust-lang.org/nightly/core/convert/trait.Into.html' title='core::convert::Into'>Into</a>&lt;<a class='struct' href='../pencil/routing/struct.Matcher.html' title='pencil::routing::Matcher'>Matcher</a>&gt;&gt;(&amp;mut self, rule: M, endpoint: &amp;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.str.html'>str</a>, view_func: <a class='type' href='../pencil/type.ViewFunc.html' title='pencil::ViewFunc'>ViewFunc</a>)</code></h4>
<div class='docblock'><p>This is a shortcut for <code>route</code>, register a view function for
a given URL rule with just <code>PUT</code> method.</p>
</div><h4 id='method.add_url_rule' class='method'><code>fn <a href='#method.add_url_rule' class='fnname'>add_url_rule</a>(&amp;mut self, matcher: <a class='struct' href='../pencil/routing/struct.Matcher.html' title='pencil::routing::Matcher'>Matcher</a>, methods: <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.slice.html'>&amp;[</a><a class='enum' href='../pencil/method/enum.Method.html' title='pencil::method::Method'>Method</a><a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.slice.html'>]</a>, endpoint: &amp;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.str.html'>str</a>, view_func: <a class='type' href='../pencil/type.ViewFunc.html' title='pencil::ViewFunc'>ViewFunc</a>)</code></h4>
<div class='docblock'><p>Connects a URL rule.</p>
</div><h4 id='method.register_module' class='method'><code>fn <a href='#method.register_module' class='fnname'>register_module</a>(&amp;mut self, module: <a class='struct' href='../pencil/struct.Module.html' title='pencil::Module'>Module</a>)</code></h4>
<div class='docblock'><p>Register a module on the application.</p>
</div><h4 id='method.enable_static_file_handling' class='method'><code>fn <a href='#method.enable_static_file_handling' class='fnname'>enable_static_file_handling</a>(&amp;mut self)</code></h4>
<div class='docblock'><p>Enables static file handling.</p>
</div><h4 id='method.before_request' class='method'><code>fn <a href='#method.before_request' class='fnname'>before_request</a>(&amp;mut self, f: <a class='type' href='../pencil/type.BeforeRequestFunc.html' title='pencil::BeforeRequestFunc'>BeforeRequestFunc</a>)</code></h4>
<div class='docblock'><p>Registers a function to run before each request.</p>
</div><h4 id='method.after_request' class='method'><code>fn <a href='#method.after_request' class='fnname'>after_request</a>(&amp;mut self, f: <a class='type' href='../pencil/type.AfterRequestFunc.html' title='pencil::AfterRequestFunc'>AfterRequestFunc</a>)</code></h4>
<div class='docblock'><p>Registers a function to run after each request.  Your function
must take a response object and modify it.</p>
</div><h4 id='method.teardown_request' class='method'><code>fn <a href='#method.teardown_request' class='fnname'>teardown_request</a>(&amp;mut self, f: <a class='type' href='../pencil/type.TeardownRequestFunc.html' title='pencil::TeardownRequestFunc'>TeardownRequestFunc</a>)</code></h4>
<div class='docblock'><p>Registers a function to run at the end of each request,
regardless of whether there was an error or not.</p>
</div><h4 id='method.register_http_error_handler' class='method'><code>fn <a href='#method.register_http_error_handler' class='fnname'>register_http_error_handler</a>(&amp;mut self, status_code: <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.u16.html'>u16</a>, f: <a class='type' href='../pencil/type.HTTPErrorHandler.html' title='pencil::HTTPErrorHandler'>HTTPErrorHandler</a>)</code></h4>
<div class='docblock'><p>Registers a function as one http error handler.
Same to <code>httperrorhandler</code>.</p>
</div><h4 id='method.register_user_error_handler' class='method'><code>fn <a href='#method.register_user_error_handler' class='fnname'>register_user_error_handler</a>(&amp;mut self, error_desc: &amp;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.str.html'>str</a>, f: <a class='type' href='../pencil/type.UserErrorHandler.html' title='pencil::UserErrorHandler'>UserErrorHandler</a>)</code></h4>
<div class='docblock'><p>Registers a function as one user error handler.
Same to <code>usererrorhandler</code>.</p>
</div><h4 id='method.httperrorhandler' class='method'><code>fn <a href='#method.httperrorhandler' class='fnname'>httperrorhandler</a>(&amp;mut self, status_code: <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.u16.html'>u16</a>, f: <a class='type' href='../pencil/type.HTTPErrorHandler.html' title='pencil::HTTPErrorHandler'>HTTPErrorHandler</a>)</code></h4>
<div class='docblock'><p>Registers a function as one http error handler.  Example:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>use</span> <span class='ident'>pencil</span>::{<span class='ident'>Pencil</span>, <span class='ident'>PencilResult</span>, <span class='ident'>Response</span>};
<span class='kw'>use</span> <span class='ident'>pencil</span>::<span class='ident'>HTTPError</span>;


<span class='kw'>fn</span> <span class='ident'>page_not_found</span>(<span class='ident'>error</span>: <span class='ident'>HTTPError</span>) <span class='op'>-&gt;</span> <span class='ident'>PencilResult</span> {
    <span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>response</span> <span class='op'>=</span> <span class='ident'>Response</span>::<span class='ident'>from</span>(<span class='string'>&quot;The page does not exist&quot;</span>);
    <span class='ident'>response</span>.<span class='ident'>status_code</span> <span class='op'>=</span> <span class='number'>404</span>;
    <span class='kw'>return</span> <span class='prelude-val'>Ok</span>(<span class='ident'>response</span>);
}


<span class='kw'>fn</span> <span class='ident'>main</span>() {
    <span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>app</span> <span class='op'>=</span> <span class='ident'>Pencil</span>::<span class='ident'>new</span>(<span class='string'>&quot;/web/demo&quot;</span>);
    <span class='ident'>app</span>.<span class='ident'>httperrorhandler</span>(<span class='number'>404</span>, <span class='ident'>page_not_found</span>);
}</pre>
</div><h4 id='method.usererrorhandler' class='method'><code>fn <a href='#method.usererrorhandler' class='fnname'>usererrorhandler</a>(&amp;mut self, error_desc: &amp;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.str.html'>str</a>, f: <a class='type' href='../pencil/type.UserErrorHandler.html' title='pencil::UserErrorHandler'>UserErrorHandler</a>)</code></h4>
<div class='docblock'><p>Registers a function as one user error handler.  There are two ways to handle
user errors currently, you can do it in your own view like this:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>use</span> <span class='ident'>pencil</span>::<span class='ident'>Request</span>;
<span class='kw'>use</span> <span class='ident'>pencil</span>::{<span class='ident'>PencilResult</span>, <span class='ident'>Response</span>};


<span class='attribute'>#[<span class='ident'>derive</span>(<span class='ident'>Clone</span>, <span class='ident'>Copy</span>)]</span>
<span class='kw'>struct</span> <span class='ident'>MyErr</span>(<span class='ident'>isize</span>);


<span class='kw'>fn</span> <span class='ident'>some_operation</span>() <span class='op'>-&gt;</span> <span class='prelude-ty'>Result</span><span class='op'>&lt;</span><span class='ident'>isize</span>, <span class='ident'>MyErr</span><span class='op'>&gt;</span> {
    <span class='kw'>return</span> <span class='prelude-val'>Err</span>(<span class='ident'>MyErr</span>(<span class='number'>10</span>));
}


<span class='kw'>fn</span> <span class='ident'>my_err_handler</span>(_: <span class='ident'>MyErr</span>) <span class='op'>-&gt;</span> <span class='ident'>PencilResult</span> {
    <span class='prelude-val'>Ok</span>(<span class='ident'>Response</span>::<span class='ident'>from</span>(<span class='string'>&quot;My err occurred!&quot;</span>))
}


<span class='kw'>fn</span> <span class='ident'>hello</span>(_: <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>Request</span>) <span class='op'>-&gt;</span> <span class='ident'>PencilResult</span> {
    <span class='kw'>match</span> <span class='ident'>some_operation</span>() {
        <span class='prelude-val'>Ok</span>(_) <span class='op'>=&gt;</span> <span class='prelude-val'>Ok</span>(<span class='ident'>Response</span>::<span class='ident'>from</span>(<span class='string'>&quot;Hello!&quot;</span>)),
        <span class='prelude-val'>Err</span>(<span class='ident'>e</span>) <span class='op'>=&gt;</span> <span class='ident'>my_err_handler</span>(<span class='ident'>e</span>),
    }
}</pre>

<p>The problem with this is that you have to do it in all of your views, it brings
a lot of redundance, so pencil provides another solution, currently I still
haven&#39;t got any better idea on how to store user error handlers, this feature is
really just experimental, if you have any good idea, please wake me up.  Here is
one simple example:</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>use</span> <span class='ident'>std</span>::<span class='ident'>convert</span>;

<span class='kw'>use</span> <span class='ident'>pencil</span>::<span class='ident'>Request</span>;
<span class='kw'>use</span> <span class='ident'>pencil</span>::{<span class='ident'>Pencil</span>, <span class='ident'>PencilResult</span>, <span class='ident'>Response</span>};
<span class='kw'>use</span> <span class='ident'>pencil</span>::{<span class='ident'>PencilError</span>, <span class='ident'>PenUserError</span>, <span class='ident'>UserError</span>};


<span class='attribute'>#[<span class='ident'>derive</span>(<span class='ident'>Clone</span>, <span class='ident'>Copy</span>)]</span>
<span class='kw'>pub</span> <span class='kw'>struct</span> <span class='ident'>MyErr</span>(<span class='ident'>isize</span>);

<span class='kw'>impl</span> <span class='ident'>convert</span>::<span class='ident'>From</span><span class='op'>&lt;</span><span class='ident'>MyErr</span><span class='op'>&gt;</span> <span class='kw'>for</span> <span class='ident'>PencilError</span> {
    <span class='kw'>fn</span> <span class='ident'>from</span>(<span class='ident'>err</span>: <span class='ident'>MyErr</span>) <span class='op'>-&gt;</span> <span class='ident'>PencilError</span> {
        <span class='kw'>let</span> <span class='ident'>user_error</span> <span class='op'>=</span> <span class='ident'>UserError</span>::<span class='ident'>new</span>(<span class='string'>&quot;MyErr&quot;</span>);
        <span class='kw'>return</span> <span class='ident'>PenUserError</span>(<span class='ident'>user_error</span>);
    }
}


<span class='kw'>fn</span> <span class='ident'>my_err_handler</span>(_: <span class='ident'>UserError</span>) <span class='op'>-&gt;</span> <span class='ident'>PencilResult</span> {
    <span class='prelude-val'>Ok</span>(<span class='ident'>Response</span>::<span class='ident'>from</span>(<span class='string'>&quot;My err occurred!&quot;</span>))
}


<span class='kw'>fn</span> <span class='ident'>some_operation</span>() <span class='op'>-&gt;</span> <span class='prelude-ty'>Result</span><span class='op'>&lt;</span><span class='ident'>String</span>, <span class='ident'>MyErr</span><span class='op'>&gt;</span> {
    <span class='kw'>return</span> <span class='prelude-val'>Err</span>(<span class='ident'>MyErr</span>(<span class='number'>10</span>));
}


<span class='kw'>fn</span> <span class='ident'>hello</span>(_: <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>Request</span>) <span class='op'>-&gt;</span> <span class='ident'>PencilResult</span> {
    <span class='kw'>let</span> <span class='ident'>rv</span> <span class='op'>=</span> <span class='macro'>try</span><span class='macro'>!</span>(<span class='ident'>some_operation</span>());
    <span class='kw'>return</span> <span class='prelude-val'>Ok</span>(<span class='ident'>rv</span>.<span class='ident'>into</span>());
}


<span class='kw'>fn</span> <span class='ident'>main</span>() {
    <span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>app</span> <span class='op'>=</span> <span class='ident'>Pencil</span>::<span class='ident'>new</span>(<span class='string'>&quot;/web/demo&quot;</span>);
    <span class='comment'>// Use error description as key to store handlers, really ugly...</span>
    <span class='ident'>app</span>.<span class='ident'>usererrorhandler</span>(<span class='string'>&quot;MyErr&quot;</span>, <span class='ident'>my_err_handler</span>);
}</pre>
</div><h4 id='method.register_template' class='method'><code>fn <a href='#method.register_template' class='fnname'>register_template</a>(&amp;mut self, template_name: &amp;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.str.html'>str</a>)</code></h4>
<div class='docblock'><p>Load and compile and register a template.</p>
</div><h4 id='method.render_template' class='method'><code>fn <a href='#method.render_template' class='fnname'>render_template</a>&lt;T:&nbsp;<a class='trait' href='../rustc_serialize/json/trait.ToJson.html' title='rustc_serialize::json::ToJson'>ToJson</a>&gt;(&amp;self, template_name: &amp;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.str.html'>str</a>, context: &amp;T) -&gt; <a class='type' href='../pencil/type.PencilResult.html' title='pencil::PencilResult'>PencilResult</a></code></h4>
<div class='docblock'><p>We use <code>handlebars-rs</code> as template engine.
Renders a template from the template folder with the given context.
The template name is the name of the template to be rendered.
The context is the variables that should be available in the template.</p>
</div><h4 id='method.render_template_string' class='method'><code>fn <a href='#method.render_template_string' class='fnname'>render_template_string</a>&lt;T:&nbsp;<a class='trait' href='../rustc_serialize/json/trait.ToJson.html' title='rustc_serialize::json::ToJson'>ToJson</a>&gt;(&amp;self, source: &amp;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.str.html'>str</a>, context: &amp;T) -&gt; <a class='type' href='../pencil/type.PencilResult.html' title='pencil::PencilResult'>PencilResult</a></code></h4>
<div class='docblock'><p>We use <code>handlebars-rs</code> as template engine.
Renders a template from the given template source string
with the given context.
The source is the sourcecode of the template to be rendered.
The context is the variables that should be available in the template.</p>
</div><h4 id='method.handle_request' class='method'><code>fn <a href='#method.handle_request' class='fnname'>handle_request</a>(&amp;self, request: &amp;mut <a class='struct' href='../pencil/wrappers/struct.Request.html' title='pencil::wrappers::Request'>Request</a>) -&gt; <a class='struct' href='../pencil/wrappers/struct.Response.html' title='pencil::wrappers::Response'>Response</a></code></h4>
<div class='docblock'><p>The actual application handler.</p>
</div><h4 id='method.run' class='method'><code>fn <a href='#method.run' class='fnname'>run</a>&lt;A:&nbsp;<a class='trait' href='https://doc.rust-lang.org/nightly/std/net/addr/trait.ToSocketAddrs.html' title='std::net::addr::ToSocketAddrs'>ToSocketAddrs</a>&gt;(self, addr: A)</code></h4>
<div class='docblock'><p>Runs the application on a hyper HTTP server.</p>
</div></div><h2 id='implementations'>Trait Implementations</h2><h3 class='impl'><span class='in-band'><code>impl <a class='trait' href='../hyper/server/trait.Handler.html' title='hyper::server::Handler'>Handler</a> for <a class='struct' href='../pencil/struct.Pencil.html' title='pencil::Pencil'>Pencil</a></code></span><span class='out-of-band'><div class='ghost'></div><a id='src-1189' class='srclink' href='../src/pencil/src/app.rs.html#591-606' title='goto source code'>[src]</a></span></h3>
<div class='impl-items'><h4 id='method.handle' class='method'><code>fn <a href='../hyper/server/trait.Handler.html#tymethod.handle' class='fnname'>handle</a>(&amp;self, req: <a class='struct' href='../hyper/server/request/struct.Request.html' title='hyper::server::request::Request'>HTTPRequest</a>, res: <a class='struct' href='../hyper/server/response/struct.Response.html' title='hyper::server::response::Response'>HTTPResponse</a>)</code></h4>
<div class='docblock'><p>Receives a <code>Request</code>/<code>Response</code> pair, and should perform some action on them. <a href="../hyper/server/trait.Handler.html#tymethod.handle">Read more</a></p>
</div><h4 id='method.check_continue' class='method'><code>fn <a href='../hyper/server/trait.Handler.html#method.check_continue' class='fnname'>check_continue</a>(&amp;self, <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.tuple.html'>(</a>&amp;<a class='enum' href='../pencil/method/enum.Method.html' title='pencil::method::Method'>Method</a>, &amp;<a class='enum' href='../hyper/uri/enum.RequestUri.html' title='hyper::uri::RequestUri'>RequestUri</a>, &amp;<a class='struct' href='../hyper/header/struct.Headers.html' title='hyper::header::Headers'>Headers</a><a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.tuple.html'>)</a>) -&gt; <a class='enum' href='../hyper/status/enum.StatusCode.html' title='hyper::status::StatusCode'>StatusCode</a></code></h4>
<div class='docblock'><p>Called when a Request includes a <code>Expect: 100-continue</code> header. <a href="../hyper/server/trait.Handler.html#method.check_continue">Read more</a></p>
</div><h4 id='method.on_connection_start' class='method'><code>fn <a href='../hyper/server/trait.Handler.html#method.on_connection_start' class='fnname'>on_connection_start</a>(&amp;self)</code></h4>
<div class='docblock'><p>This is run after a connection is received, on a per-connection basis (not a per-request basis, as a connection with keep-alive may handle multiple requests) <a href="../hyper/server/trait.Handler.html#method.on_connection_start">Read more</a></p>
</div><h4 id='method.on_connection_end' class='method'><code>fn <a href='../hyper/server/trait.Handler.html#method.on_connection_end' class='fnname'>on_connection_end</a>(&amp;self)</code></h4>
<div class='docblock'><p>This is run before a connection is closed, on a per-connection basis (not a per-request basis, as a connection with keep-alive may handle multiple requests) <a href="../hyper/server/trait.Handler.html#method.on_connection_end">Read more</a></p>
</div></div><h3 class='impl'><span class='in-band'><code>impl <a class='trait' href='../pencil/helpers/trait.PathBound.html' title='pencil::helpers::PathBound'>PathBound</a> for <a class='struct' href='../pencil/struct.Pencil.html' title='pencil::Pencil'>Pencil</a></code></span><span class='out-of-band'><div class='ghost'></div><a id='src-1197' class='srclink' href='../src/pencil/src/app.rs.html#608-614' title='goto source code'>[src]</a></span></h3>
<div class='impl-items'><h4 id='method.open_resource' class='method'><code>fn <a href='../pencil/helpers/trait.PathBound.html#tymethod.open_resource' class='fnname'>open_resource</a>(&amp;self, resource: &amp;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.str.html'>str</a>) -&gt; <a class='struct' href='https://doc.rust-lang.org/nightly/std/fs/struct.File.html' title='std::fs::File'>File</a></code></h4>
<div class='docblock'><p>Opens a resource from the root path folder.  Consider the following folder structure: <a href="../pencil/helpers/trait.PathBound.html#tymethod.open_resource">Read more</a></p>
</div></div><h3 class='impl'><span class='in-band'><code>impl <a class='trait' href='https://doc.rust-lang.org/nightly/core/fmt/trait.Display.html' title='core::fmt::Display'>Display</a> for <a class='struct' href='../pencil/struct.Pencil.html' title='pencil::Pencil'>Pencil</a></code></span><span class='out-of-band'><div class='ghost'></div><a id='src-1202' class='srclink' href='../src/pencil/src/app.rs.html#616-620' title='goto source code'>[src]</a></span></h3>
<div class='impl-items'><h4 id='method.fmt' class='method'><code>fn <a href='https://doc.rust-lang.org/nightly/core/fmt/trait.Display.html#tymethod.fmt' class='fnname'>fmt</a>(&amp;self, f: &amp;mut <a class='struct' href='https://doc.rust-lang.org/nightly/core/fmt/struct.Formatter.html' title='core::fmt::Formatter'>Formatter</a>) -&gt; <a class='type' href='https://doc.rust-lang.org/nightly/core/fmt/type.Result.html' title='core::fmt::Result'>Result</a></code></h4>
<div class='docblock'><p>Formats the value using the given formatter.</p>
</div></div><h3 class='impl'><span class='in-band'><code>impl <a class='trait' href='https://doc.rust-lang.org/nightly/core/fmt/trait.Debug.html' title='core::fmt::Debug'>Debug</a> for <a class='struct' href='../pencil/struct.Pencil.html' title='pencil::Pencil'>Pencil</a></code></span><span class='out-of-band'><div class='ghost'></div><a id='src-1208' class='srclink' href='../src/pencil/src/app.rs.html#622-626' title='goto source code'>[src]</a></span></h3>
<div class='impl-items'><h4 id='method.fmt-1' class='method'><code>fn <a href='https://doc.rust-lang.org/nightly/core/fmt/trait.Debug.html#tymethod.fmt' class='fnname'>fmt</a>(&amp;self, f: &amp;mut <a class='struct' href='https://doc.rust-lang.org/nightly/core/fmt/struct.Formatter.html' title='core::fmt::Formatter'>Formatter</a>) -&gt; <a class='type' href='https://doc.rust-lang.org/nightly/core/fmt/type.Result.html' title='core::fmt::Result'>Result</a></code></h4>
<div class='docblock'><p>Formats the value using the given formatter.</p>
</div></div></section>
    <section id='search' class="content hidden"></section>

    <section class="footer"></section>

    <aside id="help" class="hidden">
        <div>
            <h1 class="hidden">Help</h1>

            <div class="shortcuts">
                <h2>Keyboard Shortcuts</h2>

                <dl>
                    <dt>?</dt>
                    <dd>Show this help dialog</dd>
                    <dt>S</dt>
                    <dd>Focus the search field</dd>
                    <dt>&larrb;</dt>
                    <dd>Move up in search results</dd>
                    <dt>&rarrb;</dt>
                    <dd>Move down in search results</dd>
                    <dt>&#9166;</dt>
                    <dd>Go to active search result</dd>
                    <dt>+</dt>
                    <dd>Collapse/expand all sections</dd>
                </dl>
            </div>

            <div class="infos">
                <h2>Search Tricks</h2>

                <p>
                    Prefix searches with a type followed by a colon (e.g.
                    <code>fn:</code>) to restrict the search to a given type.
                </p>

                <p>
                    Accepted types are: <code>fn</code>, <code>mod</code>,
                    <code>struct</code>, <code>enum</code>,
                    <code>trait</code>, <code>type</code>, <code>macro</code>,
                    and <code>const</code>.
                </p>

                <p>
                    Search functions by type signature (e.g.
                    <code>vec -> usize</code> or <code>* -> vec</code>)
                </p>
            </div>
        </div>
    </aside>

    

    <script>
        window.rootPath = "../";
        window.currentCrate = "pencil";
        window.playgroundUrl = "";
    </script>
    <script src="../jquery.js"></script>
    <script src="../main.js"></script>
    
    <script defer src="../search-index.js"></script>
</body>
</html>